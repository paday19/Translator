<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>文枢 | Wen Shu</title>
  <!-- 引入css配置 -->
  <link href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css" rel="stylesheet">
  <link rel="stylesheet" href="css/page-translate.css">
  <script src="https://cdn.tailwindcss.com"></script>
  <script>
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            primary: '#3B82F6',
            secondary: '#10B981',
            accent: '#8B5CF6',
            dark: '#1E293B',
            light: '#F8FAFC'
          },
          fontFamily: {
            inter: ['Inter', 'system-ui', 'sans-serif'],
          },
        },
      }
    }
  </script>
</head>

<body class="font-inter bg-gradient-to-br from-light to-blue-50 min-h-screen text-dark">
  <!-- 顶部导航栏 -->
  <header class="fixed top-0 left-0 right-0 bg-white/80 backdrop-blur z-50 shadow-sm transition-all duration-300" id="navbar">
    <div class="container mx-auto px-4 py-3 flex justify-between items-center">
      <div class="flex items-center space-x-2">
        <img src="img/logo.jpg" alt="logo" style="width: 30px; height: 30px;" />
        <h1 class="text-xl font-bold bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">文枢</h1>
      </div>

      <div class="hidden md:flex items-center space-x-6">
        <a href="page-login.html" class="text-dark/80 hover:text-primary transition-colors">注册/登录</a>
        <a href="page-history.html" class="text-dark/80 hover:text-primary py-2 transition-colors">历史记录</a>
        <a href="#" class="text-dark/80 hover:text-primary transition-colors">关于我们</a>
        <a href="#" class="text-dark/80 hover:text-primary transition-colors" id="open-setting-btn">设置</a>
      </div>
      
      <button class="md:hidden text-dark text-xl" id="mobile-menu-button">
        <i class="fa fa-bars"></i>
      </button>
    </div>

    <!-- 移动端菜单 -->
    <div class="md:hidden bg-white shadow-md absolute w-full left-0 top-full transform -translate-y-full opacity-0 pointer-events-none transition-all duration-300" id="mobile-menu">
      <div class="container mx-auto px-4 py-3 flex flex-col space-y-3">
        <a href="page-login.html" class="text-dark/80 hover:text-primary py-2 transition-colors">注册/登录</a>
        <a href="page-history.html" class="text-dark/80 hover:text-primary py-2 transition-colors">历史记录</a>
        <a href="#" class="text-dark/80 hover:text-primary py-2 transition-colors">关于我们</a>
        <a href="page-setting.html" class="text-dark/80 hover:text-primary py-2 transition-colors" id="open-setting-btn-mobile">设置</a>
      </div>
    </div>
  </header>

  <!-- 主内容区 -->
  <main class="container mx-auto px-4 pt-24 pb-16">
    <!-- 欢迎区域 -->
    <section class="text-center mb-12">
      <h2 class="text-[clamp(1.8rem,4vw,2.8rem)] font-bold mb-4 text-shadow">
        跨语言沟通，<span class="bg-gradient-to-r from-primary to-accent bg-clip-text text-transparent">无缝连接世界</span>
      </h2>
      <p class="text-lg text-dark/70 max-w-2xl mx-auto" id="welcome-desc">
        选择专业翻译模型，获取精准、快速的翻译结果，支持中英互译
      </p>
    </section>

    <!-- 模型选择区域 -->
    <section class="max-w-4xl mx-auto mb-8">
      <div class="bg-white rounded-xl shadow-md p-6 mb-6">
        <h3 class="text-xl font-semibold mb-4 flex items-center">
          <i class="fa fa-check-square-o text-primary mr-2"></i>选择翻译模型
        </h3>
        
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4" id="model-selection">
          <!-- 模型卡片 1：高速翻译模型 -->
          <div class="model-card border border-gray-200 rounded-lg p-4 hover:border-primary hover:shadow-md transition-all cursor-pointer group">
            <div class="flex justify-between items-start">
              <div>
                <h4 class="font-semibold text-lg group-hover:text-primary transition-colors">高速翻译模型</h4>
                <p class="text-sm text-dark/60 mt-1">快速响应，适合日常对话翻译</p>
              </div>
              <div class="bg-blue-50 w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fa fa-bolt text-primary text-xl"></i>
              </div>
            </div>
            <div class="mt-3 flex items-center text-sm">
              <span class="bg-green-100 text-green-800 px-2 py-0.5 rounded-full mr-2">速度优先</span>
            </div>
          </div>
          
          <!-- 模型卡片 2：高精度翻译模型 -->
          <div class="model-card border border-gray-200 rounded-lg p-4 hover:border-primary hover:shadow-md transition-all cursor-pointer group">
            <div class="flex justify-between items-start">
              <div>
                <h4 class="font-semibold text-lg group-hover:text-primary transition-colors">高精度翻译模型</h4>
                <p class="text-sm text-dark/60 mt-1">专业级翻译，适合文档、学术内容</p>
              </div>
              <div class="bg-purple-50 w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fa fa-book text-accent text-xl"></i>
              </div>
            </div>
            <div class="mt-3 flex items-center text-sm">
              <span class="bg-purple-100 text-purple-800 px-2 py-0.5 rounded-full mr-2">精度优先</span>
            </div>
          </div>
          
          <!-- 模型卡片 3：DeepSeek-R1 -->
          <div class="model-card border border-gray-200 rounded-lg p-4 hover:border-primary hover:shadow-md transition-all cursor-pointer group">
            <div class="flex justify-between items-start">
              <div>
                <h4 class="font-semibold text-lg group-hover:text-primary transition-colors">DeepSeek-R1</h4>
                <p class="text-sm text-dark/60 mt-1">AI大模型，上下文理解能力强</p>
              </div>
              <div class="bg-indigo-50 w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fa fa-archive text-accent text-xl"></i>
              </div>
            </div>
            <div class="mt-3 flex items-center text-sm">
              <span class="bg-indigo-100 text-indigo-800 px-2 py-0.5 rounded-full mr-2">AI模型</span>
            </div>
          </div>
          
          <!-- 模型卡片 4：通义千问 -->
          <div class="model-card border border-gray-200 rounded-lg p-4 hover:border-primary hover:shadow-md transition-all cursor-pointer group">
            <div class="flex justify-between items-start">
              <div>
                <h4 class="font-semibold text-lg group-hover:text-primary transition-colors">通义千问</h4>
                <p class="text-sm text-dark/60 mt-1">支持批量翻译，文化适配性好</p>
              </div>
              <div class="bg-green-50 w-10 h-10 rounded-full flex items-center justify-center">
                <i class="fa fa-files-o text-accent text-xl"></i>
              </div>
            </div>
            <div class="mt-3 flex items-center text-sm">
              <span class="bg-green-100 text-green-800 px-2 py-0.5 rounded-full mr-2">多语言</span>
            </div>
          </div>
        </div>
      
      <!-- 选中的模型显示 -->
      <div class="hidden bg-primary/10 border border-primary/30 rounded-lg p-4 mb-6 transition-all" id="selected-model-display">
        <div class="flex justify-between items-center">
          <div class="flex items-center">
            <i class="fa fa-check-circle text-primary mr-2"></i>
            <span class="font-medium">已选择：</span>
            <span class="ml-2 font-semibold" id="selected-model-name">高速翻译模型</span>
          </div>
          <button class="text-primary hover:text-primary/80 text-sm flex items-center transition-colors" id="change-model-btn">
            <i class="fa fa-refresh mr-1"></i> 更换模型
          </button>
        </div>
      </div>
    </section>
    
    <!-- 翻译输入区域 -->
    <section class="max-w-4xl mx-auto">
      <div class="input-container mb-6" id="translation-input-container">
        <div class="bg-white rounded-xl shadow-md overflow-hidden">
          <!-- 语言选择栏 -->
          <div class="flex border-b items-center">
            <div class="flex-1 p-3 flex items-center justify-between border-r" id="lang-left">
              <span class="font-medium">中文</span>
            </div>
            <button class="p-3 hover:bg-gray-100 transition-colors" id="swap-languages">
              <i class="fa fa-exchange text-primary"></i>
            </button>
            <div class="flex-1 p-3 flex items-center justify-between" id="lang-right">
              <span class="font-medium">英文</span>
            </div>
          </div>
          
          <!-- 输入区域 -->
          <div class="p-4">
            <textarea 
              id="source-text"
              placeholder="请输入要翻译的文本..." 
              class="w-full h-32 p-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary/50 resize-none"
            ></textarea>
            
            <div class="flex justify-between items-center mt-4">
              <div class="text-sm text-gray-500">
                <span id="char-count">0</span> 字符
              </div>
              
              <button 
                id="translate-btn" 
                class="bg-primary hover:bg-primary/90 text-white px-6 py-2 rounded-lg transition-all flex items-center opacity-50 cursor-not-allowed"
                disabled
              >
                <i class="fa fa-language mr-2"></i> 开始翻译
              </button>
            </div>
          </div>
        </div>
      </div>
      
      <!-- 翻译结果区域 -->
      <div class="results-container opacity-0 h-0 overflow-hidden transition-all duration-500" id="translation-results-container">
        <div class="bg-white rounded-xl shadow-md overflow-hidden">
          <div class="p-4 border-b flex justify-between items-center">
            <h3 class="font-semibold flex items-center">
              <i class="fa fa-flag-checkered text-accent mr-2"></i>翻译结果
            </h3>
            <button class="text-gray-500 hover:text-primary transition-colors" id="copy-results">
              <i class="fa fa-copy"></i> 复制结果
            </button>
          </div>
          
          <div class="p-4" id="results-content">
            <!-- 结果将在这里显示 -->
            <div class="text-center text-gray-500 py-10">
              <i class="fa fa-file-text-o text-4xl mb-3 opacity-30"></i>
              <p>翻译结果将显示在这里</p>
            </div>
          </div>
        </div>
        
        <!-- 历史记录区域已删除 -->
      </div>
    </section>
    
    <!-- 功能特点 -->
    <section class="max-w-5xl mx-auto mt-16 grid grid-cols-1 md:grid-cols-3 gap-6">
      <div class="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-all">
        <div class="w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mb-4">
          <i class="fa fa-bolt text-primary text-xl"></i>
        </div>
        <h3 class="text-lg font-semibold mb-2">快速响应</h3>
        <p class="text-gray-600">毫秒级响应速度，即时获取翻译结果，不等待</p>
      </div>
      
      <div class="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-all">
        <div class="w-12 h-12 bg-purple-100 rounded-full flex items-center justify-center mb-4">
          <i class="fa fa-check-circle text-accent text-xl"></i>
        </div>
        <h3 class="text-lg font-semibold mb-2">精准翻译</h3>
        <p class="text-gray-600">AI智能识别语境，确保翻译结果准确传达原意</p>
      </div>
      
      <div class="bg-white rounded-xl shadow-sm p-6 hover:shadow-md transition-all">
        <div class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mb-4">
          <i class="fa fa-globe text-secondary text-xl"></i>
        </div>
        <h3 class="text-lg font-semibold mb-2">多语支持</h3>
        <p class="text-gray-600">支持全球多种语言互译，满足不同场景需求</p>
      </div>
    </section>
  </main>

  <!-- 页脚 -->
  <footer class="bg-dark text-white/70 py-10">
    <div class="container mx-auto px-4">
      <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
        <div>
          <div class="flex items-center space-x-2 mb-4">
            <h3 class="text-white font-bold">文枢</h3>
          </div>
          <p class="text-sm">让语言不再是障碍，连接全球沟通</p>
        </div>
        
        <div>
          <h4 class="text-white font-semibold mb-4">功能</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="hover:text-primary transition-colors">文本翻译</a></li>
            <li><a href="#" class="hover:text-primary transition-colors">文档翻译</a></li>
            <li><a href="#" class="hover:text-primary transition-colors">图片翻译</a></li>
          </ul>
        </div>
        
        <div>
          <h4 class="text-white font-semibold mb-4">支持</h4>
          <ul class="space-y-2 text-sm">
            <li><a href="#" class="hover:text-primary transition-colors">帮助中心</a></li>
            <li><a href="#" class="hover:text-primary transition-colors">联系我们</a></li>
            <li><a href="#" class="hover:text-primary transition-colors">使用条款</a></li>
          </ul>
        </div>
        
        <div>
          <h4 class="text-white font-semibold mb-4">关注我们</h4>
          <div class="flex space-x-4 mb-4">
            <a href="#" class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
              <i class="fa fa-weixin"></i>
            </a>
            <a href="#" class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
              <i class="fa fa-weibo"></i>
            </a>
            <a href="#" class="w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-primary transition-colors">
              <i class="fa fa-github"></i>
            </a>
          </div>
          <p class="text-sm">订阅获取最新功能更新</p>
          <div class="mt-2 flex">
            <input type="email" placeholder="您的邮箱" class="px-3 py-2 text-sm bg-white/10 rounded-l-lg focus:outline-none focus:bg-white/20 w-full">
            <button class="bg-primary hover:bg-primary/90 px-3 py-2 rounded-r-lg transition-colors">
              <i class="fa fa-paper-plane"></i>
            </button>
          </div>
        </div>
      </div>
      
      <div class="border-t border-white/10 mt-8 pt-6 text-center text-sm">
        <p>© 2025 文枢 版权所有</p>
      </div>
    </div>
  </footer>

  <!-- 通知提示 -->
  <div id="notification" class="fixed bottom-4 right-4 bg-dark text-white px-4 py-3 rounded-lg shadow-lg transform translate-y-20 opacity-0 transition-all duration-300 flex items-center">
    <i class="fa fa-check-circle text-secondary mr-2"></i>
    <span id="notification-text">操作成功</span>
  </div>

  <!-- 设置弹窗 -->
  <div id="setting-modal" class="fixed inset-0 bg-transparent flex items-center justify-center z-[999] opacity-0 pointer-events-none transition-all duration-300">
    <div class="bg-white rounded-xl shadow-2xl w-[90vw] max-w-md p-6 relative">
      <button id="close-setting-btn" class="absolute top-3 right-3 text-gray-400 hover:text-primary text-xl">
        <i class="fa fa-times"></i>
      </button>
      <h2 class="text-lg font-bold mb-4 text-dark">设置</h2>
      <!-- 头像上传 -->
      <div class="mb-6">
        <label class="block font-medium mb-2 text-dark">头像上传</label>
        <div class="flex items-center space-x-4">
          <img id="avatar-preview" src="img/logo_purple.jpg" alt="头像" class="w-14 h-14 rounded-full border object-cover">
          <input type="file" id="avatar-upload" accept="image/*" class="block text-sm">
        </div>
      </div>
      <!-- 字体大小（滑动条替换按钮） -->
      <div class="mb-6">
        <label class="block font-medium mb-2 text-dark">字体大小</label>
        <div class="flex items-center space-x-4">
          <input type="range" id="font-size-range" min="14" max="20" step="1" value="16" class="w-full">
          <span id="font-size-value" class="ml-2 text-dark">16px</span>
        </div>
      </div>
      <!-- 背景色 -->
      <div class="mb-2">
        <label class="block font-medium mb-2 text-dark">背景色</label>
        <div class="flex items-center space-x-4">
          <!-- radio button 样式：外圈+选中时圆心，深浅色按钮样式一致 -->
          <label class="flex items-center cursor-pointer">
            <input type="radio" name="bg-mode" class="sr-only bg-mode-radio" value="light" data-mode="light">
            <span class="w-6 h-6 flex items-center justify-center rounded-full border-2 border-gray-300 bg-white">
              <span class="radio-dot w-3 h-3 rounded-full bg-black opacity-0"></span>
            </span>
            <span class="ml-1 text-sm text-dark">浅色</span>
          </label>
          <label class="flex items-center cursor-pointer">
            <input type="radio" name="bg-mode" class="sr-only bg-mode-radio" value="dark" data-mode="dark">
            <span class="w-6 h-6 flex items-center justify-center rounded-full border-2 border-gray-300 bg-white">
              <span class="radio-dot w-3 h-3 rounded-full bg-black opacity-0"></span>
            </span>
            <span class="ml-1 text-sm text-dark">深色</span>
          </label>
        </div>
      </div>
      <!-- 操作按钮 -->
      <div class="flex justify-end space-x-4 mt-6">
        <button id="setting-cancel-btn" class="px-4 py-2 rounded bg-gray-200 text-dark hover:bg-gray-300">取消</button>
        <button id="setting-confirm-btn" class="px-4 py-2 rounded bg-primary text-white hover:bg-primary/90">确定</button>
      </div>
    </div>
  </div>

  <!-- 引入page-translate.js -->
  <script src="js/page-translate.js"></script>
  <!-- 设置相关JS -->
  <script>
    // 当前设置（应用到主界面的值）
    let currentSettings = {
      avatar: 'img/logo_purple.jpg',
      fontSize: '16px',
      bgMode: 'light'
    };
    // 临时设置（弹窗内的值）
    let tempSettings = {...currentSettings};

    // 设置弹窗显示/隐藏
    const settingModal = document.getElementById('setting-modal');
    const openSettingBtn = document.getElementById('open-setting-btn');
    const openSettingBtnMobile = document.getElementById('open-setting-btn-mobile');
    const closeSettingBtn = document.getElementById('close-setting-btn');
    const confirmBtn = document.getElementById('setting-confirm-btn');
    const cancelBtn = document.getElementById('setting-cancel-btn');
    const avatarUpload = document.getElementById('avatar-upload');
    const avatarPreview = document.getElementById('avatar-preview');
    const fontSizeRange = document.getElementById('font-size-range');
    const fontSizeValue = document.getElementById('font-size-value');
    const bgModeBtns = document.querySelectorAll('.bg-mode-btn');
    const bgModeRadios = document.querySelectorAll('.bg-mode-radio');

    // radio按钮逻辑
    function updateBgModeRadioUI(selectedMode) {
      bgModeRadios.forEach(radio => {
        const dot = radio.nextElementSibling.querySelector('.radio-dot');
        if (radio.dataset.mode === selectedMode) {
          radio.checked = true;
          if (dot) dot.style.opacity = '1';
        } else {
          radio.checked = false;
          if (dot) dot.style.opacity = '0';
        }
      });
    }
    // 打开弹窗时同步临时设置
    function openSettingModal() {
      // 头像
      avatarPreview.src = currentSettings.avatar;
      // 字体滑动条
      let sizeNum = parseInt(currentSettings.fontSize);
      fontSizeRange.value = sizeNum;
      fontSizeValue.textContent = sizeNum + 'px';
      // 背景按钮
      updateBgModeRadioUI(currentSettings.bgMode);
      // 临时设置同步
      tempSettings = {...currentSettings};
      settingModal.classList.remove('opacity-0', 'pointer-events-none');
      settingModal.classList.add('opacity-100');
    }

    openSettingBtn && openSettingBtn.addEventListener('click', openSettingModal);
    openSettingBtnMobile && openSettingBtnMobile.addEventListener('click', (e) => {
      e.preventDefault();
      openSettingModal();
    });
    // 关闭弹窗（取消/关闭按钮）
    function closeSettingModal() {
      settingModal.classList.add('opacity-0', 'pointer-events-none');
      settingModal.classList.remove('opacity-100');
    }
    closeSettingBtn && closeSettingBtn.addEventListener('click', closeSettingModal);
    cancelBtn && cancelBtn.addEventListener('click', closeSettingModal);
    confirmBtn && confirmBtn.addEventListener('click', closeSettingModal);
    // 头像上传（只更新临时设置，不立即应用）
    avatarUpload && avatarUpload.addEventListener('change', function() {
      const file = this.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          avatarPreview.src = e.target.result;
          tempSettings.avatar = e.target.result;
        };
        reader.readAsDataURL(file);
      }
    });

    // 字体大小滑动条（仅弹窗内预览，不立即应用到主界面）
    fontSizeRange && fontSizeRange.addEventListener('input', function() {
      let val = this.value;
      fontSizeValue.textContent = val + 'px';
      tempSettings.fontSize = val + 'px';
      // 只预览所有输入和结果区域内的 textarea 字体大小
      document.querySelectorAll('.input-container textarea, #results-content textarea').forEach(area => {
        area.style.fontSize = val + 'px';
      });
    });

    // 背景色切换（只更新临时设置，不立即应用）
    bgModeRadios.forEach(radio => {
      radio.addEventListener('change', function() {
        updateBgModeRadioUI(this.dataset.mode);
        tempSettings.bgMode = this.dataset.mode;
      });
    });

    // 应用设置（点击“确定”后才应用）
     function applySettings(settings) {
      window.applyResultsTheme();
      // 只设置所有输入和结果区域内的 textarea 字体大小
      document.querySelectorAll('.input-container textarea, #results-content textarea').forEach(area => {
        area.style.fontSize = settings.fontSize;
      });

      // 不再设置 document.body.style.fontSize，避免影响页面其他字体

      // 翻译结果区域深色/浅色切换
      const resultsContent = document.getElementById('results-content');
      const resultsTextareas = resultsContent ? resultsContent.querySelectorAll('textarea') : [];
      if (settings.bgMode === 'light') {
        if (resultsContent) {
          resultsContent.classList.remove('bg-gray-900', 'text-white', 'border-gray-700');
          resultsContent.classList.add('bg-white', 'text-dark', 'border-gray-200');
          resultsContent.style.backgroundColor = '';
          resultsContent.style.color = '';
          resultsContent.style.borderColor = '';
        }
        resultsTextareas.forEach(function(textarea) {
          textarea.classList.remove('bg-gray-900', 'text-white', 'border-gray-700');
          textarea.classList.add('bg-white', 'text-dark', 'border-gray-200');
          textarea.style.backgroundColor = '';
          textarea.style.color = '';
          textarea.style.borderColor = '';
        });
      } else {
        if (resultsContent) {
          resultsContent.classList.remove('bg-white', 'text-dark', 'border-gray-200');
          resultsContent.classList.add('bg-gray-900', 'text-white', 'border-gray-700');
          resultsContent.style.backgroundColor = '#1e293b';
          resultsContent.style.color = '#e5e7eb';
          resultsContent.style.borderColor = '#334155';
        }
        resultsTextareas.forEach(function(textarea) {
          textarea.classList.remove('bg-white', 'text-dark', 'border-gray-200');
          textarea.classList.add('bg-gray-900', 'text-white', 'border-gray-700');
          textarea.style.backgroundColor = '#1e293b';
          textarea.style.color = '#e5e7eb';
          textarea.style.borderColor = '#334155';
        });
      }

      // 背景色相关逻辑保持不变
      // 头像（可选：同步到主界面其他头像区域）
      // avatarPreview.src = settings.avatar; // 弹窗内已同步
      // 字体大小
      // 背景色
      const welcomeDesc = document.getElementById('welcome-desc');
      const modelCards = document.querySelectorAll('.model-card');
      const modelSectionBox = document.querySelector('.max-w-4xl.mx-auto.mb-8 > div');
      const selectedModelDisplay = document.getElementById('selected-model-display');
      const inputContainers = document.querySelectorAll('.input-container > div');
      const resultsContainers = document.querySelectorAll('.results-container > div');
      const historyCards = document.querySelectorAll('#translation-results-container > div');
      // 文本框
      const textareasAll = document.querySelectorAll('textarea');
      // 功能特点卡片
      // 修改选择器，确保所有卡片都能切换
      const featureCards = document.querySelectorAll('.max-w-5xl .rounded-xl.shadow-sm');

      if (settings.bgMode === 'light') {
        document.body.classList.remove('dark');
        document.body.classList.add('bg-gradient-to-br', 'from-light', 'to-blue-50', 'text-dark');
        document.body.classList.remove('bg-gray-900', 'text-white');
        if (welcomeDesc) welcomeDesc.style.color = '';
        // 模型选择区域外层
        if (modelSectionBox) {
          modelSectionBox.classList.remove('bg-gray-900', 'border-gray-700', 'text-white');
          modelSectionBox.classList.add('bg-white', 'border-gray-200', 'text-dark');
        }
        // 选中模型显示区域
        if (selectedModelDisplay) {
          selectedModelDisplay.classList.remove('bg-gray-900', 'border-gray-700', 'text-white');
          selectedModelDisplay.classList.add('bg-primary/10', 'border-primary/30', 'text-dark');
        }
        // 卡片浅色
        modelCards.forEach(card => {
          card.classList.remove('bg-gray-900', 'border-gray-700', 'text-white');
          card.classList.add('bg-white', 'border-gray-200', 'text-dark');
        });
        inputContainers.forEach(card => {
          card.classList.remove('bg-gray-900', 'border-gray-700', 'text-white');
          card.classList.add('bg-white', 'border-gray-200', 'text-dark');
        });
        resultsContainers.forEach(card => {
          card.classList.remove('bg-gray-900', 'border-gray-700', 'text-white');
          card.classList.add('bg-white', 'border-gray-200', 'text-dark');
        });
        historyCards.forEach(card => {
          card.classList.remove('bg-gray-900', 'border-gray-700', 'text-white');
          card.classList.add('bg-white', 'border-gray-200', 'text-dark');
        });
        // 文本框浅色
        textareasAll.forEach(area => {
          area.classList.remove('bg-gray-900', 'text-white', 'border-gray-700');
          area.classList.add('bg-white', 'text-dark', 'border-gray-200');
          area.style.backgroundColor = '';
          area.style.color = '';
          area.style.borderColor = '';
        });
        // 功能特点卡片浅色
        featureCards.forEach(card => {
          card.classList.remove('bg-gray-900', 'text-white');
          card.classList.add('bg-white', 'text-dark');
        });

        // 设置弹窗浅色
        settingModal.classList.remove('bg-gray-900', 'bg-black/30');
        settingModal.classList.add('bg-transparent');
        const modalBox = settingModal.querySelector('> div');
        if (modalBox) {
          modalBox.classList.remove('bg-gray-900', 'text-white');
          modalBox.classList.add('bg-white', 'text-dark');
        }
      } else {
        document.body.classList.add('dark');
        document.body.classList.remove('bg-gradient-to-br', 'from-light', 'to-blue-50', 'text-dark');
        document.body.classList.add('bg-gray-900', 'text-white');
        if (welcomeDesc) welcomeDesc.style.color = '#e5e7eb';
        // 模型选择区域外层
        if (modelSectionBox) {
          modelSectionBox.classList.remove('bg-white', 'border-gray-200', 'text-dark');
          modelSectionBox.classList.add('bg-gray-900', 'border-gray-700', 'text-white');
        }
        // 选中模型显示区域
        if (selectedModelDisplay) {
          selectedModelDisplay.classList.remove('bg-primary/10', 'border-primary/30', 'text-dark');
          selectedModelDisplay.classList.add('bg-gray-900', 'border-gray-700', 'text-white');
        }
        // 卡片深色
        modelCards.forEach(card => {
          card.classList.remove('bg-white', 'border-gray-200', 'text-dark');
          card.classList.add('bg-gray-900', 'border-gray-700', 'text-white');
        });
        inputContainers.forEach(card => {
          card.classList.remove('bg-white', 'border-gray-200', 'text-dark');
          card.classList.add('bg-gray-900', 'border-gray-700', 'text-white');
        });
        resultsContainers.forEach(card => {
          card.classList.remove('bg-white', 'border-gray-200', 'text-dark');
          card.classList.add('bg-gray-900', 'border-gray-700', 'text-white');
        });
        historyCards.forEach(card => {
          card.classList.remove('bg-white', 'border-gray-200', 'text-dark');
          card.classList.add('bg-gray-900', 'border-gray-700', 'text-white');
        });
        // 文本框深色
        textareasAll.forEach(area => {
          area.classList.remove('bg-white', 'text-dark', 'border-gray-200');
          area.classList.add('bg-gray-900', 'text-white', 'border-gray-700');
          area.style.backgroundColor = '#1e293b';
          area.style.color = '#e5e7eb';
          area.style.borderColor = '#334155';
        });
        // 功能特点卡片深色
        featureCards.forEach(card => {
          card.classList.remove('bg-white', 'text-dark');
          card.classList.add('bg-gray-900', 'text-white');
        });

        // 设置弹窗深色
        settingModal.classList.remove('bg-black/30', 'bg-gray-900');
        settingModal.classList.add('bg-transparent');
        const modalBox = settingModal.querySelector('> div');
        if (modalBox) {
          modalBox.classList.remove('bg-white', 'text-dark');
          modalBox.classList.add('bg-gray-900', 'text-white');
        }
      }
    }

    // 结果区域样式应用函数
    function applyResultsTheme() {
      const resultsContent = document.getElementById('results-content');
      const mode = currentSettings.bgMode;
      // 处理所有 textarea
      const allTextareas = document.querySelectorAll('#results-content textarea');
      allTextareas.forEach(function(textarea) {
        if (mode === 'light') {
          textarea.classList.remove('bg-gray-900', 'text-white', 'border-gray-700');
          textarea.classList.add('bg-white', 'text-dark', 'border-gray-200');
          textarea.style.backgroundColor = '';
          textarea.style.color = '';
          textarea.style.borderColor = '';
        } else {
          textarea.classList.remove('bg-white', 'text-dark', 'border-gray-200');
          textarea.classList.add('bg-gray-900', 'text-white', 'border-gray-700');
          textarea.style.backgroundColor = '#1e293b';
          textarea.style.color = '#e7e9eb';
          textarea.style.borderColor = '#334155';
        }
      });

      // 处理所有 .p-3.bg-gray-50.rounded-lg.min-h-[100px] 结果块
      const resultBlocks = document.querySelectorAll('#results-content .p-3');
      resultBlocks.forEach(function(block) {
        if (mode === 'light') {
          block.classList.remove('bg-gray-900', 'text-white', 'border-gray-700');
          block.classList.add('bg-gray-50', 'text-dark');
          block.style.backgroundColor = '';
          block.style.color = '';
          block.style.borderColor = '';
        } else {
          block.classList.remove('bg-gray-50', 'text-dark');
          block.classList.add('bg-gray-900', 'text-white', 'border-gray-700');
          block.style.backgroundColor = '#1e293b';
          block.style.color = '#e7e9eb';
          block.style.borderColor = '#334155';
        }
      });

      // 如果没有textarea和结果块，才处理resultsContent本身
      if (allTextareas.length === 0 && resultBlocks.length === 0 && resultsContent) {
        if (mode === 'light') {
          resultsContent.classList.remove('bg-gray-900', 'text-white', 'border-gray-700');
          resultsContent.classList.add('bg-white', 'text-dark', 'border-gray-200');
          resultsContent.style.backgroundColor = '';
          resultsContent.style.color = '';
          resultsContent.style.borderColor = '';
        } else {
          resultsContent.classList.remove('bg-white', 'text-dark', 'border-gray-200');
          resultsContent.classList.add('bg-gray-900', 'text-white', 'border-gray-700');
          resultsContent.style.backgroundColor = '#1e293b';
          resultsContent.style.color = '#e7e9eb';
          resultsContent.style.borderColor = '#334155';
        }
      }
    }

    // 确定按钮：应用临时设置到主界面
    confirmBtn && confirmBtn.addEventListener('click', function() {
      currentSettings = {...tempSettings};
      applySettings(currentSettings);
      applyResultsTheme();
      // 新增：应用结果和特色卡片主题
      if (typeof window.applyResultsTheme === 'function') {
        window.applyResultsTheme();
      }
      closeSettingModal();
    });

    // 页面初始化时应用当前设置
    window.addEventListener('DOMContentLoaded', function() {
      applySettings(currentSettings);
      // 新增：初始化时应用结果和特色卡片主题
      if (typeof window.applyResultsTheme === 'function') {
        window.applyResultsTheme();
      }
    });

    // 挂载到 window，供外部 JS 调用
    window.applyResultsTheme = applyResultsTheme;
  </script>
</body>
</html>
</html>
